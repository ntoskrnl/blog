{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/blog/compose-user-avatar-placeholder",
    "result": {"data":{"site":{"siteMetadata":{"title":"Anton Danshin"}},"markdownRemark":{"id":"8551b0a9-b199-5c6d-a06b-3f9f0a3b45bb","excerpt":"When you want to display different users in your app, it is a good idea to provide an image. For example, when scrolling through the list some people would…","html":"<p>When you want to display different users in your app, it is a good idea to provide an image. For example, when scrolling through the list some people would mostly pay attention to the text, but some will look at images. That’s why a lot of apps that contain list of people, (e.g. a Contacts app), always provide an avatar.</p>\n<p>Not all users might have avatars. If the avatar is missing, it is often replaced with a placeholder. I find that the best placeholder should contain user initials and have a different color per user. This way, it is easier to identify different people in the list just by looking at the avatar placeholder.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7f63bef6c3b81bb0107600e4a734c676/d1882/material-letter-icons.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.62025316455696%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/0lEQVQI1wH0AAv/AOL49ZTk2d/39P///6bsxLXuzf///9Tb/665/vb6///z8e2Wl/bLy//////UtP/MqP///PPe/9uU/vXj/wBDz7wAv6RG0MKR57YFyFYS0Fui29FVZ/8gQfqBnv/yc2nVCAncMjf6t5j/fRb/dQz9vZe8QP+rAfzCR/8AO825AL+kPc6/gOOsBshXDc9YktTKTmD/JEX5dZP/8GVb1AgJ2igt+ayJ/3cM/3EF/LOMuDP/qgD8vTn/ANP073bcztDz7/3//IrlsZvpvP///8bO/5in/u70///q5+h5evO5uf/////Emf+8jf//+O7O/9J3/vHU/6YAq+QqAuEOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Material letter icons as avatar placeholders\"\n        title=\"Material letter icons as avatar placeholders\"\n        src=\"/static/7f63bef6c3b81bb0107600e4a734c676/f058b/material-letter-icons.png\"\n        srcset=\"/static/7f63bef6c3b81bb0107600e4a734c676/c26ae/material-letter-icons.png 158w,\n/static/7f63bef6c3b81bb0107600e4a734c676/6bdcf/material-letter-icons.png 315w,\n/static/7f63bef6c3b81bb0107600e4a734c676/f058b/material-letter-icons.png 630w,\n/static/7f63bef6c3b81bb0107600e4a734c676/40601/material-letter-icons.png 945w,\n/static/7f63bef6c3b81bb0107600e4a734c676/78612/material-letter-icons.png 1260w,\n/static/7f63bef6c3b81bb0107600e4a734c676/d1882/material-letter-icons.png 1562w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>In this article, I will look into how we can draw such an avatar placeholder in Jetpack Compose.</p>\n<h2>Requirements</h2>\n<p>Just list a few requirements to our avatar placeholder:</p>\n<ul>\n<li>It should display the initials of the user on a circle with some background color.</li>\n<li>Text must always be legible with a good contrast ratio – e.g., black text on a brown background is no good.</li>\n<li>If two users have the same initials, the color should be different.</li>\n<li>For the same user, it should use the same background color.</li>\n</ul>\n<h2>Implementation</h2>\n<p>Input: user ID and full name.</p>\n<ol>\n<li>Convert user data to color using HSV color space.</li>\n<li>Draw a circle.</li>\n<li>Draw Initials.</li>\n<li>Put it all together.</li>\n</ol>\n<h3>Generating color by user name</h3>\n<p>In our code, we represent color as a 32-bit integer (ARGB format). What if we use a hashcode of the user name as color? It might work, but we often end up having colors that are too dark, too light, or even too transparent.</p>\n<p>Ideally, we want our color to have a fixed brightness – different users would have different color of the same brightness and saturation levels. Lucky for us there are color encodings that split the color into exactly these components.</p>\n<blockquote>\n<p><strong>HSL</strong> (for hue, saturation, lightness) and <strong>HSV</strong> (for hue, saturation, value; also known as <strong>HSB</strong>, for hue, saturation, brightness) are alternative representations of the <strong>RGB</strong> color model, designed in the 1970s by computer graphics researchers to more closely align with the way human vision perceives color-making attributes. In these models, colors of each hue are arranged in a radial slice, around a central axis of neutral colors which ranges from black at the bottom to white at the top. — <a href=\"https://en.wikipedia.org/wiki/HSL_and_HSV\">Wikipedia</a></p>\n</blockquote>\n<p>We can use HSL color space and fix saturation and lightness. In my app I found that <code class=\"language-text\">lightness = 0.4f</code> and <code class=\"language-text\">saturation = 0.5f</code> work the best.</p>\n<p>Here is how we can convert a <code class=\"language-text\">String</code> into a color in Android using <code class=\"language-text\">HSL</code> color space:</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@ColorInt</span>\n<span class=\"token keyword\">fun</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">toHslColor</span><span class=\"token punctuation\">(</span>\n    saturation<span class=\"token operator\">:</span> Float <span class=\"token operator\">=</span> <span class=\"token number\">0.5f</span><span class=\"token punctuation\">,</span>\n    lightness<span class=\"token operator\">:</span> Float <span class=\"token operator\">=</span> <span class=\"token number\">0.4f</span>\n    <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Int <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">val</span> hashCode <span class=\"token operator\">=</span> <span class=\"token function\">fold</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> acc<span class=\"token punctuation\">,</span> char <span class=\"token operator\">-></span> char<span class=\"token punctuation\">.</span>code <span class=\"token operator\">+</span> acc <span class=\"token operator\">*</span> <span class=\"token number\">37</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">val</span> hue <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>hue <span class=\"token operator\">%</span> <span class=\"token number\">360</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>absoluteValue<span class=\"token punctuation\">.</span><span class=\"token function\">toFloat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> ColorUtils<span class=\"token punctuation\">.</span><span class=\"token function\">HSLToColor</span><span class=\"token punctuation\">(</span><span class=\"token function\">floatArrayOf</span><span class=\"token punctuation\">(</span>hue<span class=\"token punctuation\">,</span> saturation<span class=\"token punctuation\">,</span> lightness<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We can then generate a color by user name:</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token comment\">// generate full name string</span>\n<span class=\"token keyword\">val</span> name <span class=\"token operator\">=</span> <span class=\"token function\">listOf</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">joinToString</span><span class=\"token punctuation\">(</span>separator <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">uppercase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">val</span> color <span class=\"token operator\">=</span> name<span class=\"token punctuation\">.</span><span class=\"token function\">toHslColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The only problem here is that users that share the same name will be given the same color. This can be fixed by adding user ID into the mix.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">val</span> color <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">id</span></span><span class=\"token string\"> / </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">name</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">toHslColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Drawing background circle</h3>\n<p>Now we can simply draw a circle for a given user full name on <code class=\"language-text\">Canvas</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token function\">Canvas</span><span class=\"token punctuation\">(</span>modifier <span class=\"token operator\">=</span> Modifier<span class=\"token punctuation\">.</span><span class=\"token function\">fillMaxSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">drawCircle</span><span class=\"token punctuation\">(</span><span class=\"token function\">SolidColor</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Draw initials</h3>\n<p>To draw initials on top of our background, we need to wrap both of them with a <code class=\"language-text\">Box</code> layout.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token function\">Box</span><span class=\"token punctuation\">(</span>contentAlignment <span class=\"token operator\">=</span> Alignment<span class=\"token punctuation\">.</span>Center<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token keyword\">val</span> initials <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">.</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> lastName<span class=\"token punctuation\">.</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">uppercase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">Text</span><span class=\"token punctuation\">(</span>text <span class=\"token operator\">=</span> initials<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Putting it all together</h3>\n<p>When creating a component, it would be a good idea to provide some basic customization. In my implementation, I only need to have different sizes and text styles.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token annotation builtin\">@Composable</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">UserHead</span><span class=\"token punctuation\">(</span>\n    id<span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    firstName<span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    lastName<span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    modifier<span class=\"token operator\">:</span> Modifier <span class=\"token operator\">=</span> Modifier<span class=\"token punctuation\">,</span>\n    size<span class=\"token operator\">:</span> Dp <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">.</span>dp<span class=\"token punctuation\">,</span>\n    textStyle<span class=\"token operator\">:</span> TextStyle <span class=\"token operator\">=</span> MaterialTheme<span class=\"token punctuation\">.</span>typography<span class=\"token punctuation\">.</span>subtitle1<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">Box</span><span class=\"token punctuation\">(</span>modifier<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> contentAlignment <span class=\"token operator\">=</span> Alignment<span class=\"token punctuation\">.</span>Center<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">val</span> name <span class=\"token operator\">=</span> <span class=\"token function\">listOf</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">joinToString</span><span class=\"token punctuation\">(</span>separator <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">uppercase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">val</span> color <span class=\"token operator\">=</span> <span class=\"token function\">Color</span><span class=\"token punctuation\">(</span><span class=\"token string-literal singleline\"><span class=\"token string\">\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">id</span></span><span class=\"token string\"> / </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$</span><span class=\"token expression\">name</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">toHslColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">val</span> initials <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">.</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> lastName<span class=\"token punctuation\">.</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">uppercase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">Image</span><span class=\"token punctuation\">(</span>\n            painter <span class=\"token operator\">=</span> <span class=\"token function\">ColorPainter</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            modifier <span class=\"token operator\">=</span> Modifier<span class=\"token punctuation\">.</span><span class=\"token function\">clip</span><span class=\"token punctuation\">(</span>CircleShape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            contentDescription <span class=\"token operator\">=</span> <span class=\"token string-literal singleline\"><span class=\"token string\">\"Avatar\"</span></span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token function\">Canvas</span><span class=\"token punctuation\">(</span>modifier <span class=\"token operator\">=</span> Modifier<span class=\"token punctuation\">.</span><span class=\"token function\">fillMaxSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">drawCircle</span><span class=\"token punctuation\">(</span><span class=\"token function\">SolidColor</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">Text</span><span class=\"token punctuation\">(</span>text <span class=\"token operator\">=</span> initials<span class=\"token punctuation\">,</span> style <span class=\"token operator\">=</span> textStyle<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>White<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here is how the component is rendered:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/41bfed567aabfc18eae15a48c53ef39c/47730/circle-avatar-placeholder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjklEQVQoz52Sy27aQBSGeYnAwilZgBmPZ4aZAVpRxTI3g4MByeGiVoIWRXmDSFlk0UdpniGrqIu821/NcZwoWUVZfDq/zpzzz+1UarUa6qenqHsexTOvgHKfoFKtVuE3m1BSQgiBpixwWpZI+QbxnFPv8q62Uj05AWcMptOBNQY/lcYPpUlra6G1LpqVejGy1lIMRbExrUkJY0xhGDAGaQ1uwzYeWBsPXONGajApcJGmOB6P2Gw22O12WK1WuMxz7Pd7bLdbHA4Hwq33er3CsMUYvmmNe9nB068rPP2+xl/ZgVEK8WCARZYhSRIsl0uMx2PEcUzGWZZRnE6nmM/nr4buhMoY/JEGj93v+NePcSc0uFKYJgnt7sxck2t2RrPZDHmeY7FYYL1eo9vt0tXfvOFXY3AlFI6hQs9atI1Bv9/HaDSiUw2HQ0RRRPo8ijCZTEinaUp17r3pl5uNBkQYIuAcjTAkOOcIOUcQBGCt1gvuNmVs+T5p3/epztVXyjn84uaQZtAjnC5n88N4Hv4DLbocTuFez+YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Avatar placeholder with initials and color background example\"\n        title=\"Avatar placeholder with initials and color background example\"\n        src=\"/static/41bfed567aabfc18eae15a48c53ef39c/47730/circle-avatar-placeholder.png\"\n        srcset=\"/static/41bfed567aabfc18eae15a48c53ef39c/c26ae/circle-avatar-placeholder.png 158w,\n/static/41bfed567aabfc18eae15a48c53ef39c/6bdcf/circle-avatar-placeholder.png 315w,\n/static/41bfed567aabfc18eae15a48c53ef39c/47730/circle-avatar-placeholder.png 428w\"\n        sizes=\"(max-width: 428px) 100vw, 428px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Conclusion</h2>\n<p>With just 20 lines of code, we have created a simple Jetpack Compose component to display a colorful avatar placeholder with user initials. Follow <a href=\"https://gist.github.com/ntoskrnl/14622d88cad3387d14786aa259e4653f\">this link</a> to see all the code.</p>","fields":{"slug":"/compose-user-avatar-placeholder","readingTime":{"text":"4 min read"}},"frontmatter":{"title":"Material avatar placeholder in Jetpack Compose","date":"October 17, 2021","updated":"October 17, 2021","description":"Implementing avatar placeholder with initials on colored circle in Jetpack Compose.","draft":false}},"previous":{"fields":{"slug":"/compose-timer-implementation"},"frontmatter":{"title":"Countdown timer with Jetpack Compose"}},"next":{"fields":{"slug":"/effective-team-communication-in-slack"},"frontmatter":{"title":"Effective team communication in Slack"}}},"pageContext":{"id":"8551b0a9-b199-5c6d-a06b-3f9f0a3b45bb","previousPostId":"0f69fca0-7040-5cbd-94d3-8cdce7c0d88f","nextPostId":"fd5ed88e-0345-5c2f-b13f-003bd732822a"}},
    "staticQueryHashes": ["2841359383","3274528899"]}