<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.95fdb6ba0b55921a47d8.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:100;src:local("Roboto Thin "),local("Roboto-Thin"),url(/static/roboto-latin-100-c2aa4ab115bf9c6057cb59709d0e152b.woff2) format("woff2"),url(/static/roboto-latin-100-a45108d3b34af91f9113d827a183296d.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:100;src:local("Roboto Thin italic"),local("Roboto-Thinitalic"),url(/static/roboto-latin-100italic-7f839a8652da29745ce4260846c3f88e.woff2) format("woff2"),url(/static/roboto-latin-100italic-451d4e559d6f57cdf6a1c54a3e32e11d.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:local("Roboto Light "),local("Roboto-Light"),url(/static/roboto-latin-300-37a7069dc30fc663c8781220e5669d25.woff2) format("woff2"),url(/static/roboto-latin-300-865f928cbabcc9f8f2b50fb47a20bc63.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:300;src:local("Roboto Light italic"),local("Roboto-Lightitalic"),url(/static/roboto-latin-300italic-c64e7e354c88e613c77cab8ac2ebc3ae.woff2) format("woff2"),url(/static/roboto-latin-300italic-bd5b7a13f2c52b531a2a787bf6eb4a13.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:local("Roboto Regular "),local("Roboto-Regular"),url(/static/roboto-latin-400-176f8f5bd5f02b3abfcf894955d7e919.woff2) format("woff2"),url(/static/roboto-latin-400-49ae34d4cc6b98c00c69ab4c41de3e0c.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:400;src:local("Roboto Regular italic"),local("Roboto-Regularitalic"),url(/static/roboto-latin-400italic-d022bc70dc1bf7b3425da9cdaa9841b6.woff2) format("woff2"),url(/static/roboto-latin-400italic-b1d9d9904bfca8802a631c45590b9efa.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:local("Roboto Medium "),local("Roboto-Medium"),url(/static/roboto-latin-500-f5b74d7ffcdf85b9dd60130fa0b2c087.woff2) format("woff2"),url(/static/roboto-latin-500-cea99d3e3e13a3a599a015c29f1046d0.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:500;src:local("Roboto Medium italic"),local("Roboto-Mediumitalic"),url(/static/roboto-latin-500italic-0d8bb5b3ee5f5dac9e446d48480d28a9.woff2) format("woff2"),url(/static/roboto-latin-500italic-18d00f739ff1e1c52db1a1c0d9e98129.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:700;src:local("Roboto Bold "),local("Roboto-Bold"),url(/static/roboto-latin-700-c18ee39fb002ad58b6dc595476f88fef.woff2) format("woff2"),url(/static/roboto-latin-700-2267169ee7270a22a963b2b2bfb7ab0c.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:700;src:local("Roboto Bold italic"),local("Roboto-Bolditalic"),url(/static/roboto-latin-700italic-7d8125ff7f707231fd89d9d7109deadf.woff2) format("woff2"),url(/static/roboto-latin-700italic-9360531f9bb817f917f01a6d394515f3.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:900;src:local("Roboto Black "),local("Roboto-Black"),url(/static/roboto-latin-900-870c8c1486f76054301a22c35403eae1.woff2) format("woff2"),url(/static/roboto-latin-900-bac8362e7a6ea60b6983ecf09a411a5e.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:900;src:local("Roboto Black italic"),local("Roboto-Blackitalic"),url(/static/roboto-latin-900italic-cb5ad999740e9d8a8bd1b03b379293a9.woff2) format("woff2"),url(/static/roboto-latin-900italic-c20d916c1a1b094c1cec7de61e470633.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-3xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Roboto,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Lato,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-sans);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.125;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.875rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-4);margin-top:var(--spacing-8)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-semibold)}h1{border-bottom:1px solid var(--color-accent);color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-bold);padding-bottom:var(--spacing-1)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:inside;margin-bottom:var(--spacing-4);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol,ol li,ul,ul li{padding-left:var(--spacing-0)}ol li,ul li{margin-bottom:calc(var(--spacing-4)/2)}article.blog-post ol,article.blog-post ul{padding-left:var(--spacing-4)}li>p{margin-bottom:calc(var(--spacing-4)/2)}ol li+li{margin-top:var(--spacing-1)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:normal;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-header,.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-top:var(--spacing-0)}.post-list-item h2,.post-list-item header{margin-bottom:var(--spacing-2)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{align-items:center;display:flex;margin-bottom:var(--spacing-8)}.bio-avatar,.bio p{margin-bottom:var(--spacing-0)}.bio-avatar{margin-right:var(--spacing-4);min-width:50px}.bio-avatar,.bio-avatar img{border-radius:100%}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;margin:var(--spacing-0);padding:0}.blog-post-comments{margin-top:var(--spacing-12)}.gatsby-highlight{margin-bottom:var(--spacing-6)}:not(pre)>code[class*=language-],pre>code[class*=language-]{font-size:var(--fontSize-0)}code[class*=language-] .token.operator{background:none}.line-numbers-rows{padding-top:1em}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}</style><meta name="generator" content="Gatsby 3.14.3"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><title data-react-helmet="true">Refactor your Gradle build configuration with convention plugins | Anton Danshin</title><meta data-react-helmet="true" name="description" content="How Gradle precompiled script plugins help put your multi-module project&#x27;s build logic in order."/><meta data-react-helmet="true" property="og:title" content="Refactor your Gradle build configuration with convention plugins"/><meta data-react-helmet="true" property="og:description" content="How Gradle precompiled script plugins help put your multi-module project&#x27;s build logic in order."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="Refactor your Gradle build configuration with convention plugins"/><meta data-react-helmet="true" name="twitter:description" content="How Gradle precompiled script plugins help put your multi-module project&#x27;s build logic in order."/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-754243770225268fbc1f.js"/><link as="script" rel="preload" href="/framework-76eef0d74e46daf0dd60.js"/><link as="script" rel="preload" href="/app-ccb2af4490d18090773f.js"/><link as="script" rel="preload" href="/commons-49d87760e0d259853722.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-3f0cbe5d54978e491770.js"/><link as="fetch" rel="preload" href="/page-data/blog/gradle-convention-plugins/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3274528899.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">Anton Danshin</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline"> <!-- -->Refactor your Gradle build configuration with convention plugins</h1><p>December 10, 2021<!-- --> | <!-- -->5 min read</p></header><section itemProp="articleBody"><p>Many Android projects contain more than one module (subproject). In a product oriented project, it will be one app module and many library modules. When the team is developing white-label apps, it will be many apps on top of many library modules.</p>
<p>Here is what I often see in our project. When creating a new module, some developers would use Android Studio GUI and then adjust it according to what they need. Others would simply copy-paste some existing module and change it. Some people would even write build configuration from scratch. Generally, there is nothing wrong with this. Bu over time, this practice had caused us several issues:</p>
<ul>
<li><strong>Inconsistencies.</strong> build configuration might differ from module to module (e.g., could have different <code class="language-text">compileSdkVersion</code>).</li>
<li><strong>Poor maintainability.</strong> If we need to apply some new setting to all modules, we will have to change them all.</li>
<li><strong>Redundant logic.</strong> Build configuration may contain redundant parameters / code, developers are afraid to remove it to break something.</li>
</ul>
<p>Since we are making wite-labels apps, we have created a script that automates some of the copy-paste we have to do in order to bootstrap the boilerplate for new apps. The amount of duplication in the build logic grows even faster.</p>
<h2>Sharing external dependencies and versions accross Gradle modules</h2>
<p>One of the common things developers do, is introducing constants for external libraries. In many projects I see on Github, all versions and library locators are placed to <code class="language-text">versions.gradle</code> in the project’s root directory. The file typically declares version of different libraries and plugins, and also groups all libraries by vendor Then, all the versions and dependencse are placed into Gradle’s <a href="https://docs.gradle.org/current/dsl/org.gradle.api.plugins.ExtraPropertiesExtension.html">ExtraPropertiesExtension</a>, aka <code class="language-text">ext</code>.</p>
<blockquote>
<p>I’ve heard that using <code class="language-text">ext</code> to keep common parameters across subprojects is not a very good practice. I don’t know why exactly… I could certainly find some of its drawbacks if I try. However, our project is currenly using this approach.</p>
</blockquote>
<p>Gradle team noticed the trend and came up with a solution called <a href="https://docs.gradle.org/current/userguide/platforms.html">Version Catalogs</a>, which is currently a feature preview. The feature allows you to define versions and libraries in a <code class="language-text">*.toml</code> file. Gradle will generate type-safe accessors based on the declarations in the file.</p>
<p>You could try using it for new projects. However, if you already have your own “version catalog” that works for you, I don’t really see a need to migrate to the Gradle solution. Compared to defining versions in a Gradle or Kotlin script with IDE support, I found it quite annoying that you have to edit <code class="language-text">*.toml</code>. Apart from syntax highlighing, IDE doesn’t help you with the code completion (at least as of the time of writing this post there was an <a href="https://youtrack.jetbrains.com/issue/IDEA-262280">open issue</a> about that), and you can easily mess it up.</p>
<h2>Sharing common build logic accross Gradle modules</h2>
<p>Common pattern that people do here, is either putting the code into <code class="language-text">subprojects {}</code> block of root <code class="language-text">build.gradle</code> file, or put configuration logic into a separate gradle file and apply it to specific module via <code class="language-text">apply from: 'file.gradle'</code>.</p>
<p>This is a solution, but because you cannot often split root <code class="language-text">build.gradle</code> into separate files, the file becomes inflated. This also causes subprojects to implicitly <strong>rely</strong> on configuration logic written in the root <code class="language-text">build.gradle</code>.</p>
<p>Fortunately, now there is an easy way split the common build logic into separate gradle files (plugins) that also make subprojects explicitely declare that they are using this configuration. This approach is based on a Gradle feature <a href="https://docs.gradle.org/current/userguide/custom_plugins.html#sec:precompiled_plugins">Precompiled Script Plugins</a> and this is now a recommend way for sharing build logic accorss modules in larger projects. Such precompiled plugins that contain pieces of shared build logic are often referred to as <em>Convention plugins</em>.</p>
<p>If you don’t have many modules, I think it still OK writing your common build logic the old way. But as project grows, you may not notice how your 10 modules became 30, and 30 become 50… So, why not invest a little bit of time and set up a future proof structure at the early?</p>
<blockquote>
<p>Before applying it to your project, always check whether the benefits that the convention plugins bring outweigh the drawbacks (e.g. potentially slower build or some other issue).</p>
</blockquote>
<p><strong>The benefits</strong> of using convention plugins are:</p>
<ol>
<li>Just like with <code class="language-text">subprojects { }</code> configuration block, you will be able to extract common logic in one place.</li>
<li>You will be able separate common logic into completely independent bits, which should be easier to maintain.</li>
<li>You explicitly apply different convention plugins to different modules.</li>
</ol>
<blockquote>
<p>By the way! It is possible to migrate to the new approach slowly. I am currently implementing it in our project and have only applied the plugins to a subset of modules. Seems to be working fine.</p>
</blockquote>
<p><strong>The drawbacks</strong> that I noticed are:</p>
<ol>
<li>It requires you to use newer Gradle, as well as new <code class="language-text">pluginManagement {}</code>, which has some issues when used together with the older <code class="language-text">builscript</code>. Ideally, all projects should migrate to new approach.</li>
<li>It will take a little extra time to compile included build.</li>
<li>This is not the default way, so when you introduce new team members to the project, they will have to learn your new “conventions”.</li>
</ol>
<h2>Resources</h2>
<p>Before you start digging into this topic, I recommend reading the intro to <a href="https://docs.gradle.org/current/userguide/custom_plugins.html#sec:precompiled_plugins">Precompiled Script Plugins</a> from Gradle. Then explore the examples below:</p>
<ol>
<li><a href="https://docs.gradle.org/current/samples/sample_convention_plugins.html">Convention plugins</a> – Oficial sample from Gradle.</li>
<li><a href="https://github.com/dsvoronin/march-meetup-gradle">Android Sample</a> – More realistic sample with of Android project.</li>
<li><a href="https://github.com/avito-tech/avito-android/tree/develop/build-logic">Real project usage</a></li>
</ol>
<p>Also, I would highly recommend reading Gradle <a href="https://docs.gradle.org/current/userguide/task_configuration_avoidance.html">Task Configuration Avoidance</a> guidelines. Might be useful when writing custom plugins.</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/6cc7eac2bddc48d85d772de6b33e2757/d4bf4/profile-pic.avif 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/6cc7eac2bddc48d85d772de6b33e2757/3faea/profile-pic.webp 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/6cc7eac2bddc48d85d772de6b33e2757/d24ee/profile-pic.jpg" data-srcset="/static/6cc7eac2bddc48d85d772de6b33e2757/d24ee/profile-pic.jpg 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/6cc7eac2bddc48d85d772de6b33e2757/d4bf4/profile-pic.avif 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/6cc7eac2bddc48d85d772de6b33e2757/3faea/profile-pic.webp 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/6cc7eac2bddc48d85d772de6b33e2757/d24ee/profile-pic.jpg" srcSet="/static/6cc7eac2bddc48d85d772de6b33e2757/d24ee/profile-pic.jpg 50w,/static/6cc7eac2bddc48d85d772de6b33e2757/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><p>Written by <strong>Anton Danshin</strong> —<!-- --> <!-- -->🧑‍💻 Android developer, ☕️ Starbucks coffee addict</p></div></footer></article><nav class="blog-post-nav"><ul><li><a rel="prev" href="/blog/effective-team-communication-in-slack">← <!-- -->Effective team communication in Slack</a></li><li></li></ul></nav><div class="blog-post-comments"><div id="disqus_thread"></div></div></main><footer>© <!-- -->2021<!-- -->, Built with Gatsby</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XECRJ1095L"></script><script>
      
      
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-XECRJ1095L', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/gradle-convention-plugins";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4dee193ac7596a1a9c93.js"],"app":["/app-ccb2af4490d18090773f.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6527a8d4f085db6b22e6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-067f4301914a2344ea3f.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-749ac0383f19ce924803.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-3f0cbe5d54978e491770.js"]};/*]]>*/</script><script src="/polyfill-4dee193ac7596a1a9c93.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-3f0cbe5d54978e491770.js" async=""></script><script src="/commons-49d87760e0d259853722.js" async=""></script><script src="/app-ccb2af4490d18090773f.js" async=""></script><script src="/framework-76eef0d74e46daf0dd60.js" async=""></script><script src="/webpack-runtime-754243770225268fbc1f.js" async=""></script></body></html>